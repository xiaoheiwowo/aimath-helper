# AIMath Helper - 数学练习助手

一个完整的数学练习教学系统，支持出题、学生答题、自动批改、错误分析和针对性练习生成。

## 功能特性

- 🤖 AI 驱动的知识点提取和题目生成
- 📝 支持选择题和计算题两种题型
- 📷 OCR 识别学生手写答题内容
- ✅ 自动批改学生答案
- 📊 错误知识点分析和统计
- 🎯 根据错误模式生成针对性练习
- 📁 完整的会话管理和历史记录
- 🎨 现代化的 Web 界面

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置环境变量

创建 `.env` 文件并填入您的 API 配置：

```bash
# 阿里云通义千问API配置
OPENAI_API_KEY=your_OPENAI_API_KEY_here

# 数据存储目录
DATA_DIR=./data
```

### 3. 运行程序

```bash
python run.py
```

程序将在 `http://localhost:7860` 启动。

## 使用方法

### 完整工作流程

1. **第一步：生成练习题目**
   - 输入出题要求（如："生成关于有理数加法的练习题目"）
   - 系统自动提取相关知识点
   - 根据知识点从题库中随机选择题目
   - 生成包含选择题和计算题的练习试卷

2. **第二步：学生答题**
   - 学生完成练习后，拍照上传答题图片
   - 系统使用 OCR 识别学生的手写内容
   - 自动解析为结构化的答题数据

3. **第三步：自动批改**
   - 系统自动批改选择题和计算题
   - 对计算题进行步骤级别的分析
   - 生成详细的批改报告

4. **第四步：错误分析**
   - 分析学生的错误模式
   - 统计错误最多的知识点
   - 生成错误分析报告

5. **第五步：针对性练习**
   - 根据错误知识点重新生成练习题目
   - 帮助学生重点练习薄弱环节

## 数据存储

- 所有生成的数据保存在 `data/` 目录下
- 每个会话使用 `ID_时间戳` 格式命名
- 每个会话包含：
  - `session_data.json`：完整会话数据
  - `images/`：学生答题图片
  - 包含出题要求、知识点、练习数据、学生答案、批改结果、错误分析等

## 项目结构

```
aimath-helper/
├── data/                   # 数据存储目录
├── src/
│   ├── ai.py              # AI处理模块
│   ├── complete_ui.py     # 完整界面
│   ├── gradio_ui.py       # 原始界面
│   ├── question/          # 题库模块
│   │   ├── bank.py        # 题库管理
│   │   ├── model.py       # 数据模型
│   │   └── questions.json # 题目数据
│   ├── practice/          # 练习模块
│   │   ├── practice.py    # 练习管理
│   │   └── template.py    # 模板渲染
│   ├── session.py         # 会话管理
│   └── knowledge_base.py  # 知识点数据库
├── requirements.txt       # 依赖包
└── README.md             # 说明文档
```

## 依赖包

- `gradio`：Web 界面框架
- `openai`：AI API 客户端
- `python-dotenv`：环境变量管理
- `jinja2`：模板引擎
- `PIL`：图像处理